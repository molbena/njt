jQuery(document).ready(function($){$(window).scroll(function(){if($(this).scrollTop()>500){$("#scrollToTOP").fadeIn(200);}else{$("#scrollToTOP").fadeOut(200);}});$("#scrollToTOP").on("click",function(){$("html, body").animate({scrollTop:0,},300);return false;});$(".user-popup-trigger").on("click",function(event){event.preventDefault();$(".user-popup").addClass("is-visible");});$(".user-popup").on("click",function(event){if($(event.target).is(".user-popup-close")||$(event.target).is(".user-popup")){event.preventDefault();$(this).removeClass("is-visible");}});$(document).keyup(function(event){if(event.which=="27"){$(".user-popup").removeClass("is-visible");}});$(".search-popup-trigger").on("click",function(event){event.preventDefault();$(".search-popup").addClass("is-visible");});$(".search-popup").on("click",function(event){if($(event.target).is(".search-popup-close")||$(event.target).is(".search-popup")){event.preventDefault();$(this).removeClass("is-visible");}});$(document).keyup(function(event){if(event.which=="27"){$(".search-popup").removeClass("is-visible");}});if($(".navbar-site li").hasClass("menu-item-has-children")){$(".navbar-site li.menu-item-has-children > a").prepend('<span class="submenu-icon text-xs iconfont icon-arrow"></span>');}
if($(".navbar-bottom").length>0){var innerHeight=window.innerHeight;var mainHeight=$(".site-main").innerHeight();var menuOffset=$(".navbar-bottom").offset().top;$(window).scroll(function(){var amountScrolled=$(window).scrollTop();if(mainHeight>innerHeight){if(amountScrolled>=menuOffset){$(".site-header").removeClass("not-stuck");$(".site-header").addClass("stuck");}else{$(".site-header").removeClass("stuck");$(".site-header").addClass("not-stuck");}}});}
if($(".sidebar").length>0){$(".sidebar").theiaStickySidebar({additionalMarginTop:75,additionalMarginBottom:50,});}
if($(".header-menu .menu-item , .mobile-sidebar-menu .menu-item").hasClass("menu-item-has-children")){$(".header-menu .menu-item-has-children , .mobile-sidebar-menu > ul > .menu-item-has-children").children("a").append('<span class="menu-icon"><i class="text-sm iconfont icon-arrow"></i></span>');}
$(document).on("click",".mobile-sidebar-menu .menu-item-has-children > a",function(event){var i=$(this);i.siblings(".mobile-sidebar-menu .sub-menu")[0]&&(event.preventDefault(),i.parent().hasClass("in")?(i.parent().removeClass("in"),i.parent().find(".in").removeClass("in"),i.parent().find(".sub-menu").stop(!0).slideUp(300)):(i.closest(".in")[0]||(i.find(".menu-item-has-children.in .sub-menu").stop(!0).slideUp(300),i.find(".menu-item-has-children.in").removeClass("in")),i.parent().addClass("in"),i.parent().siblings(".in").find(".sub-menu").stop(!0).slideUp(300),i.parent().siblings(".current-menu-parent").find(".sub-menu").stop(!0).slideUp(300),i.parent().siblings(".in").removeClass("in"),i.siblings(".sub-menu").stop(!0).slideDown(300)));});$(document).on("click","#mobile-sidebar-trigger",function(event){event.preventDefault();$(".site-sidebar").addClass("open");$("body").addClass("modal-open");});$(document).on("click","#mobile-sidebar-close,.mobile-overlay",function(event){$(".site-sidebar").removeClass("open");$("body").removeClass("modal-open");});$(window).resize(function(){$(".site-sidebar").removeClass("open");$("body").removeClass("modal-open");});if($(".site-banner").length>0){var swiper=new Swiper(".site-banner .swiper-container",{pagination:{el:".swiper-pagination",},spaceBetween:10,});}
if($(".comment-input").length>0){document.querySelectorAll(".comment-input").forEach((el)=>{el.style.height=el.setAttribute("style","height: "+el.scrollHeight+"px");el.classList.add("auto");el.addEventListener("input",(e)=>{el.style.height="auto";el.style.height=el.scrollHeight+"px";});});}
function ajax_load_comments(data){var buttonDOM=$("#comments-next-button");buttonDOM.hide();$.ajax({url:globals.ajax_url,type:"POST",dataType:"html",data:data,}).done(function(response){if(response){if(data.commentspage=="newest"){buttonDOM.data("paged",data.paged*1-1);}else{buttonDOM.data("paged",data.paged*1+1);}
$("."+data.append).append(response);buttonDOM.show();}else{buttonDOM.hide();}});}
$(document).on("click","#comments-next-button",function(event){event.preventDefault();ajax_load_comments($("#comments-next-button").data());});function isElementInViewport(el){var rect=el.getBoundingClientRect();return(rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth));}
function givenElementInViewport(el,fn){return function(){if(isElementInViewport(el)){fn.call();}};}
function addViewportEvent(el,fn){if(window.addEventListener){addEventListener("DOMContentLoaded",givenElementInViewport(el,fn),false);addEventListener("load",givenElementInViewport(el,fn),false);addEventListener("scroll",givenElementInViewport(el,fn),false);addEventListener("resize",givenElementInViewport(el,fn),false);}else if(window.attachEvent){attachEvent("DOMContentLoaded",givenElementInViewport(el,fn));attachEvent("load",givenElementInViewport(el,fn));attachEvent("scroll",givenElementInViewport(el,fn));attachEvent("resize",givenElementInViewport(el,fn));}}
$(document).on("click",".dposts-ajax-load",function(event){event.preventDefault();var $this=jQuery(this);if($(".list-ajax-load").hasClass("loading")===false){$(".list-ajax-load").addClass("loading");ajax_load_posts($this.data());}});if($(".list-ajax-load").length>0){addViewportEvent(document.querySelector(".list-ajax-load"),function(){if($(".dposts-ajax-load").data("comments")=="comments"){return false;}
if($(".list-ajax-load").hasClass("loading")===false){var data=$(".dposts-ajax-load").data();if($(".dposts-ajax-load").data("paged")<=3){$(".list-ajax-load").addClass("loading");ajax_load_posts($(".dposts-ajax-load").data());}}});}
function ajax_load_posts(data,callback=function(){}){$(".ajax-loading").show();var loadButton=$(".dposts-ajax-load");var listAjaxLoad=$(".list-ajax-load");loadButton.hide();$.ajax({url:globals.ajax_url,type:"POST",dataType:"html",data:data,}).done(function(response){callback();loadButton.removeAttr("disabled");if(response.trim()){loadButton.data("paged",data.paged*1+1);$("."+data.append).append(response);listAjaxLoad.removeClass("loading").show();}else{loadButton.attr("disabled","disabled");loadButton.addClass("disabled");loadButton.text(__.reached_the_end).show();}}).fail(function(){$(".ajax-loading").hide();}).always(function(){$(".ajax-loading").hide();loadButton.show();});}
$(document).on("click",".single-popup",function(event){event.preventDefault();var img=$(this).data("img");var title=$(this).data("title");var desc=$(this).data("desc");var html='<div class="text-center"><h5>'+
title+'</h5>\
                    <div class="text-muted text-sm mt-2" > '+
desc+' </div>\
                    <img src="'+
img+'" alt="'+
title+'" style="width:100%;height:auto;">\
                    </div>';ncPopup("small",html);});$(document).on("click",".btn-share-toggler",function(event){event.preventDefault();ncPopup("middle",$("#single-share-template").html());});$(document).on("click",".btn-report-toggler",function(event){event.preventDefault();ncPopup("middle",$("#report-popup-wrap").html());});$(document).on("click",".btn-report",function(e){e.preventDefault();var type=$(".report-popup-form input[name=report_type]:checked").val();$(".btn-report").attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"html",data:{action:"november_report",id:globals.post_id,do_action:type,},}).done(function(data){var json=JSON.parse(data);if(json.code===200){ncPopupTips(1,json.msg);return;}
ncPopupTips(0,json.msg);});});$(document).on("click",".btn-popup-user-collection",function(event){event.preventDefault();var that=$(this),data=that.data();ncPopup("mini",$("#popup-user-collection-wrap").html());var deleteBtn=$(".nice-popup .btn-collection-delete");deleteBtn.attr("data-id",data.id);deleteBtn.attr("data-nonce",data.nonce);deleteBtn.attr("data-action",data.action);});$(document).on("click",".btn-collection-delete",function(event){event.preventDefault();var that=$(this);var data=that.data();$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(res){if(res.success){$(".nice-popup-close").click();ncPopupTips(1,res.data.msg);setTimeout(function(){window.location.reload();},2000);}else{ncPopupTips(0,res.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});$(document).on("click",".collection-action",function(e){e.preventDefault();var that=$(this),data=that.data();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){if(that.hasClass("btn-dark")){that.removeClass("btn-dark").addClass("btn-light");}else{that.removeClass("btn-light").addClass("btn-dark");}
ncPopupTips(1,data.data.msg);that.find("span").text(data.data.number);}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});$(document).on("click",".follow-user-action",function(e){e.preventDefault();var that=$(this),data=that.data();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(res){var textSpan=that.find("span");if(res.success){var isFollowed=that.hasClass(data.inactive);ncPopupTips(isFollowed,res.data.msg);if(that.hasClass(data.inactive)){that.removeClass(data.inactive).addClass(data.active);if(textSpan.length){textSpan.text(__.followed);}else{that.attr("data-tooltip",__.followed);}}else{that.removeClass(data.active).addClass(data.inactive);if(textSpan.length){textSpan.text(__.follow_ta);}else{that.attr("data-tooltip",__.follow_ta);}}}else{ncPopupTips(0,res.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});$(document).on("click",".follow-user-action-by-list",function(e){e.preventDefault();var that=$(this),data=that.data();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(res){if(res.success){ncPopupTips(1,res.data.msg);setTimeout(function(){window.location.reload();},2000);}else{ncPopupTips(0,res.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});$(document).on("click",".subscribe-group-action",function(e){e.preventDefault();var that=$(this),data=that.data();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(res){var textSpan=that.find("span");if(res.success){if(!that.hasClass("active")){that.addClass("active");textSpan.text(__.subscribed);}else{that.removeClass("active");textSpan.text(__.subscribe);}
$(".subscribers-count").text(res.data.number);ncPopupTips(1,res.data.msg);}else{ncPopupTips(0,res.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});$(document).on("click",".subscribe-group-action-by-list",function(e){e.preventDefault();var that=$(this),data=that.data();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){ncPopupTips(0,data.data.msg);if(data.success){setTimeout(function(){window.location.reload();},1000);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){that.attr("disabled",false);});});var timer,timerNumber;$(document).on("click",'[data-action="get-captcha"]',function(e){e.preventDefault();var that=$(this),fieldName=that.data("field"),field=$('input[name="'+fieldName+'"]'),html=that.html(),placeholder=field.attr("placeholder"),data=that.data();if(fieldName!=="is_user_logged_in"){if(field.val().length===0){ncPopupTips(0,placeholder);return;}}
data.user_login=field.val();that.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){ncPopupTips(1,data.data.msg);timerNumber=data.data.timer;timer=setInterval(function(){if(timerNumber>0){timerNumber--;that.text(timerNumber);}else{timerNumber=60;that.html(html);clearInterval(timer);that.attr("disabled",false);}},1000);}else{if(data.data.timer){timerNumber=data.data.timer;timer=setInterval(function(){if(timerNumber>0){timerNumber--;that.text(timerNumber);}else{timerNumber=60;that.html(html);clearInterval(timer);that.attr("disabled",false);}},1000);}else{that.attr("disabled",false);}
ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);that.attr("disabled",false);});});$(document).on("submit","#signup,#login-form,#forgot-form",function(e){e.preventDefault();var that=$(this),data=that.serializeArray(),btn=that.find('button[type="submit"]');btn.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){ncPopupTips(1,data.data.msg);window.location.href=data.data.url;}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){btn.attr("disabled",false);});});$(document).on("submit","#update-usermeta",function(e){e.preventDefault();var that=$(this),data=that.serializeArray(),btn=that.find('button[type="submit"]');btn.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){ncPopupTips(1,data.data.msg);setTimeout(function(){window.location.reload();},2000);}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){btn.attr("disabled",false);});});var next_popup="";$(document).on("click",".profile-change-action",function(){var that=$(this),popup=that.data("popup");next_popup=popup;if(!globals.security_verification){$(".security-verification").parents(".user-popup").addClass("is-visible");}else{$("."+next_popup).parents(".user-popup").addClass("is-visible");}});$(document).on("submit","#security-verification",function(e){e.preventDefault();var that=$(this),data=that.serializeArray(),btn=that.find('button[type="submit"]');btn.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){globals.security_verification=true;ncPopupTips(1,data.data.msg);that.parents(".user-popup").removeClass("is-visible");$("."+next_popup).parents(".user-popup").addClass("is-visible");}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){btn.attr("disabled",false);});});$(document).on("submit","#change-password,#change-email,#change-phone",function(e){e.preventDefault();var that=$(this),data=that.serializeArray(),btn=that.find('button[type="submit"]');btn.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:data,}).done(function(data){if(data.success){ncPopupTips(1,data.data.msg);that.parents(".user-popup").removeClass("is-visible");}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){btn.attr("disabled",false);});});$(".hide-password").on("click",function(){var $this=$(this),$password_field=$this.prev("input");"password"==$password_field.attr("type")?$password_field.attr("type","text"):$password_field.attr("type","password");__.show==$this.text()?$this.text(__.hide):$this.text(__.show);$password_field.putCursorAtEnd();});$(document).on("click",".social-unbind",function(e){e.preventDefault();var that=$(this),btn=that;btn.attr("disabled",true);$.ajax({url:globals.ajax_url,type:"POST",dataType:"json",data:{action:"social-unbind",type:$(this).data("type"),nonce:$(this).data("nonce"),},}).done(function(data){if(data.success){ncPopupTips(1,data.data.msg);setTimeout(function(){window.location.href=window.location.href;},1500);}else{ncPopupTips(0,data.data.msg);}}).fail(function(){ncPopupTips(0,__.network_error);}).always(function(){btn.attr("disabled",false);});});});jQuery.fn.putCursorAtEnd=function(){return this.each(function(){if(this.setSelectionRange){var len=$(this).val().length*2;this.setSelectionRange(len,len);}else{$(this).val($(this).val());}});};if(typeof wechat_oauth_data!=="undefined"&&wechat_oauth_data.type==="service"){offiaccount_event_loop(wechat_oauth_data.query_id,wechat_oauth_data.nonce);}
function offiaccount_event_loop(query_id,nonce){$.ajax({type:"POST",url:globals.ajax_url,data:{action:"offiaccount-event-loop",query_id:query_id,nonce:nonce,},dataType:"json",success:function(response){if(response.status==200){ncPopupTips(1,response.msg);setTimeout(function(){window.location.href=response.url;},1000);}else if(response.status==201){offiaccount_event_loop_time=setTimeout(function(){offiaccount_event_loop(query_id,nonce);},1000);}else{ncPopupTips(0,response.msg);}},error:function(e){ncPopupTips(0,__.network_error);},});}